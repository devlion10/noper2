<!doctype html>
<html layout:decorate="~{layouts/main}"
      lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<th:block layout:fragment="LNB" th:with="userBold = true">
	<th:block th:replace="fragments/LNB :: board"></th:block>
</th:block>
<th:block layout:fragment="configScript">
	<script th:src="@{/js/board/userAllowEvent.js}"></script>
</th:block>
<!--/* 주 화면 컨텐츠 */-->
<th:block layout:fragment="content">
	<th:block th:replace="pages/common/loading :: loading"></th:block>
	<div class="content container-fluid">
		<div class="title_wrap">
			<h3 class="tit" th:text="'가입신청 ' + ${user.userId != null ? '수정' : ''}"></h3>
			<div class="loc">
				<i class="bi bi-house-fill"></i>
				<i class="bi bi-chevron-compact-right"></i>
				<span>게시판</span>
				<i class="bi bi-chevron-compact-right"></i>
				<span th:text="'가입신청 ' + ${user.userId != null ? '수정' : ''}"></span>
			</div>
		</div>
		<div>
			<form id="joinForm" action="/board/user/create" method="post" class="needs-validation" novalidate>
				<input type="hidden" name="userId" th:value="${user.userId}">
				<div class="row row-tr">
					<div class="col-1 col-th">
						<label for="skkCd" class="col-form-label col-form-label-sm">자치구<th:block th:replace="pages/common/util :: required"></th:block></label>
					</div>
					<div class="col-11">
						<!--<div class="d-flex align-items-center flex-wrap">-->
						<div class="d-flex align-items-center flex-wrap">
							<select class="form-select form-select-sm" style="width: 20%" id="skkCd" name="skkCd" required>
								<option value="" selected>시/군/구</option>
								<option th:each="val : ${skk}" th:if="!${val?.CDVALUE eq '서울특별시'}" th:value="${val?.CDKEY}" th:utext="${val?.CDVALUE}" th:selected="${val?.CDKEY == user.skkCd}"></option>
							</select>
							<div style="width: 2%"></div>
							<select id="instt" name="instt" class="form-select form-select-sm" style="width: 20%" required> <!--institution-->
								<option value="" >소속 선택</option>
								<option value="gu" th:selected="${user.dongInfo eq '000'}">구청</option>
								<option value="dong" th:selected="${user.deptCd eq '11110'}">동사무소</option>
							</select>
							<!--<small class="invalid-feedback">※ 근무중인 자치구 시/군/구/ 와 소속을 선택해주세요.</small>-->
							<div style="width: 2%"></div>
							<select id="bjdCd" name="dongInfo" class="form-select form-select-sm" th:style="${user == null ? 'display:none;' : (user.deptCd == '11110' ? 'display:block;' : 'display:none;')} + 'width: 20%;'"   required>
								<option value="" selected>동 선택</option>
								<option value="direct">직접입력</option>
								<option th:each="val : ${bjd}" th:value="${val?.key}" th:utext="${val?.dpname}" th:selected="${val?.key == user.dongInfo}"></option>
							</select>
							<select id="deptCd" name="deptCd" class="form-select form-select-sm" th:style="${user == null ? 'display:none;' : (user.dongInfo == '000' ? 'display:block;' : 'display:none;')} + 'width: 20%;'"   required>
								<option value="" selected>부서 선택</option>
								<option value="direct">직접입력</option>
								<option th:each="val : ${dept}" th:value="${val?.CDKEY}" th:utext="${val?.CDVALUE}" th:selected="${val?.CDKEY == user.deptCd}"></option>
							</select>
							<div style="width: 2%"></div>
							<input type="text" id="bjdCdDirect" name="bjdCdDirect" class="form-control form-control-sm" style="width: 20%; display:none;" disabled required><!--&ndash;&gt;-->
							<input type="text" id="deptDirect" name="deptCdDirect" class="form-control form-control-sm" style="width: 20%; display:none;" disabled required/>
							<!--<div style="width: 24%"></div>-->
							<div style="width: 2%"></div>
							<small class="invalid-feedback">※ 근무중인 자치구 및 부서나 동을 선택 또는 입력해주세요.</small>
						</div>
					</div>
				</div>
				<div class="row row-tr">
					<div class="col-1 col-th">
						<label for="userName" class="col-form-label col-form-label-sm">성명<th:block th:replace="pages/common/util :: required"></th:block></label>
					</div>
					<div class="col-5">
						<input type="text" class="form-control form-control-sm" id="userName" name="userName" placeholder="이름 입력" minlength="1" maxlength="10" data-input-type="noNumberString" th:value="${user.userName}" required>
						<small class="invalid-feedback">※ 가입 신청자명을 입력해주세요.</small>
					</div>
					<div class="col-1 col-th">
						<label for="personalId1" class="col-form-label col-form-label-sm">주민등록번호<th:block th:replace="pages/common/util :: required"></th:block></label>
					</div>
					<div class="col-5 d-flex flex-column">
						<div class="d-flex flex-wrap align-items-center">
							<input type="text" class="form-control form-control-sm side-input" id="personalId1" placeholder="숫자만 입력하세요." minlength="6" maxlength="6" data-input-type="number" data-next-input="personalId2" th:value="${#strings.substring(user?.personalId, 0, 6)}" required>
							<span class="text-center side-input-center">-</span>
							<input type="text" class="form-control form-control-sm side-input" id="personalId2" placeholder="숫자만 입력하세요." minlength="7" maxlength="7" data-input-type="number" th:value="${#strings.substring(user?.personalId, 6)}" required>
							<small class="invalid-feedback">※ 주민번호 숫자만 입력해주세요.</small>
						</div>
					</div>
				</div>
				<div class="row row-tr">
					<div class="col-1 col-th">
						<label for="eMail1" class="col-form-label col-form-label-sm">이메일<th:block th:replace="pages/common/util :: required"></th:block></label>
					</div>
					<div class="col-5 d-flex flex-column">
						<div class="d-flex flex-wrap align-items-center">
							<input type="text" class="form-control form-control-sm side-input" id="eMail1" name="eMail1" data-input-type="email" placeholder="이메일 주소를 입력하세요" th:value="${user?.eMail eq 'none'} ? '' : ${#strings.setSplit(user?.eMail, '@')[0]}" required />
							<span class="text-center side-input-center">@</span>
							<input type="text" class="form-control form-control-sm side-input" id="eMail2" name="eMail2" data-input-type="email" th:value="${user?.eMail eq 'none'} ? 'seoul.go.kr' : ${#strings.setSplit(user?.eMail, '@')[1]}" required />
							<small class="invalid-feedback">※ 이메일 주소를 입력해주세요.</small>
						</div>
					</div>
					<div class="col-1 col-th">
						<label for="telNo" class="col-form-label col-form-label-sm">전화번호<th:block th:replace="pages/common/util :: required"></th:block></label>
					</div>
					<div class="col-5 d-flex flex-wrap align-items-center">
						<input type="text" class="form-control form-control-sm" id="telNo" name="telNo" placeholder="숫자만 입력해주세요" minlength="9" maxlength="11" data-input-type="number" th:value="${user?.telNo}" required>
						<small class="invalid-feedback">※ 전화번호를 입력해주세요.</small>
					</div>
				</div>
				<div class="row row-tr">
					<div class="col-1 col-th">
						<label for="workCharge" class="col-form-label col-form-label-sm">담당업무<th:block th:replace="pages/common/util :: required"></th:block></label>
					</div>
					<div class="col-5">
						<input type="text" class="form-control form-control-sm" id="workCharge" name="workCharge" th:value="${user?.workCharge}" placeholder="담당업무를 입력해주세요" required />
						<p class="invalid-feedback">※ 담당 업무를 선택해주세요.</p>
					</div>
					<div class="col-1 col-th">
						<label for="perId" class="col-form-label col-form-label-sm">요청권한</label>
					</div>
					<div class="col-5">
						<select id="perId" name="perId" class="form-select form-select-sm" required>
							<option value="" selected>선택</option>
							<option th:each="val : ${permission}" th:value="${val?.perId}" th:utext="${(val?.perComment == null || val?.perComment == '') ? val?.perName : (val?.perName + ' - ' + val?.perComment)}" th:selected="${user?.perId} == ${val?.perId}"></option>
						</select>
						<p class="invalid-feedback">※ 권한명을 선택해주세요.</p>
					</div>
				</div>
				<p class="row text-danger ms-2">※ 입력하신 가입자 정보는 기존무허가 건축물관리 시스템 사용자 정보로 등록되며, 아이디 및 비밀번호는 가입 승인시 임의로 부여되니 참고 부탁드립니다.</p>
				<div class="row mt-2 justify-content-between">
					<div class="col-1 mt-3">
						<button id="listBtn" type="button" class="btn btn-light btn-sm float-start">목록</button>
					</div>
					<div class="col-2 mt-3">
						<button id="joinComplBtn" type="submit" class="btn btn-primary btn-sm float-end" th:text="${user.userId != null ? '수정' : '가입신청'}">가입신청</button>
						<button id="joinCancelBtn" type="button" class="btn btn-secondary btn-sm float-end me-2">취소</button>
					</div>
				</div>
				<span class="row ms-3 mt-5 border-0 bg-white bold-text" style="font-size: 22px">
					요청권한설명
				</span>
				<div class="row ms-2 mt-1 card">
					<div class="card-body">
						1. 신규대장관리자 : 기존무허가건축물을 대장에 추가(신규) 등재하여 승인해 주는 업무(팀장) 권한입니다.<br>
						2. 조회/발급 : 기존무허가건축물 조회 및 확인원 발급 업무 권한입니다.<br>
						3. 일반사용자 : 기존무허가건축물 관리, 조회, 등록 및 수정, 확인원(조회)발급, 통계조회 업무 권한입니다.<br>
						4. 위반건축물관리 : 위반건축물 관리 조회, 등록, 수정 및 통계 조회 업무 권한입니다.<br>
						5. 기존/위반 : 일반사용자 + 위반건축물관리 통합업무 권한입니다.<br>
						6. 개발제한구역 :「개발제한구역법 시행규칙」 개발제한구역 건축물관리대장의 건축물을 관리하는 권한입니다.
					</div>
				</div>
			</form>
		</div>
	</div>
</th:block>

<!--/* DOM요소 조작 혹은 이벤트 처리할 JS 추가 */-->
<th:block layout:fragment="script">
</th:block>
</html>